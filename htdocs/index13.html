<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Flash Mode | index13</title>
  <style>
    :root {
      --bg: #f5f5f7;
      --card: rgba(255, 255, 255, 0.95);
      --text: #1d1d1f;
      --muted: #86868b;
      --blue: #0071e3;
      --rainbow: linear-gradient(120deg, #ff3b30, #ff9500, #ffcc00, #34c759, #007aff, #5856d6, #ff2d55);
      --card-glass: rgba(255, 255, 255, 0.8);
    }

    * { box-sizing: border-box; -webkit-font-smoothing: antialiased; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Helvetica Neue", sans-serif;
      background: var(--bg); color: var(--text);
      display: flex; flex-direction: column; height: 100vh; overflow: hidden;
      transition: background-color 2s ease;
    }

    header {
      background: rgba(255, 255, 255, 0.8); padding: 15px 40px; 
      display: grid; grid-template-columns: 220px 1fr 220px; align-items: center;
      border-bottom: 1px solid #e5e5e5; z-index: 100;
      backdrop-filter: blur(20px);
      position: relative; overflow: hidden;
    }
    header::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(-45deg, rgba(0, 113, 227, 0.05), rgba(52, 199, 89, 0.05), rgba(255, 149, 0, 0.05), rgba(0, 113, 227, 0.05));
      background-size: 400% 400%;
      animation: headerGradient 15s ease infinite;
      z-index: 0;
    }
    @keyframes headerGradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .head-label { font-size: 11px; font-weight: 800; color: var(--muted); text-transform: uppercase; margin-right: 5px; z-index: 2; position: relative; }
    .head-val { font-variant-numeric: tabular-nums; font-weight: 700; font-size: 18px; z-index: 2; position: relative; }
    h1 { text-align: center; margin: 0; font-size: 24px; font-weight: 950; letter-spacing: -1px; z-index: 2; position: relative; }

    #flight-deck {
      background: #000; color: #fff; height: 100px; overflow: hidden;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      z-index: 90;
    }
    .deck-lbl { font-size: 11px; font-weight: 800; color: var(--muted); text-transform: uppercase; letter-spacing: 1px; }
    .slot-timer { font-family: 'Courier New', Courier, monospace; font-size: 40px; font-weight: 900; color: #ffcc00; text-shadow: 0 0 10px #ffcc0044; margin: 5px 0; }

    main { flex: 1; display: flex; align-items: center; justify-content: center; padding: 30px; position: relative; overflow: hidden; }
    .grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 25px; width: 100%; max-width: 1500px; z-index: 10; }

    .card {
      background: var(--card-glass); border-radius: 40px; padding: 35px 20px;
      text-align: center; position: relative; border: 1px solid rgba(0,0,0,0.05);
      transition: all 0.6s cubic-bezier(0.15, 1, 0.3, 1);
    }
    .card.active { transform: scale(1.08) translateY(-10px); background: #fff; box-shadow: 0 30px 60px rgba(0,0,0,0.1); border-color: transparent; }
    .card.active::before {
      content: ''; position: absolute; inset: -4px; 
      background: var(--rainbow); background-size: 200% 200%;
      border-radius: 44px; z-index: -1;
      animation: rainbowMove 3s linear infinite; filter: blur(10px); opacity: 0.5;
    }

    .session-info { font-size: 13px; font-weight: 800; color: var(--muted); text-transform: uppercase; margin-bottom: 5px; }
    .s-title { font-size: 32px; font-weight: 800; letter-spacing: -1.5px; margin-bottom: 15px; }

    .circle-wrap { width: 180px; height: 180px; margin: 0 auto; position: relative; perspective: 1000px; }
    .ring-svg { transform: rotate(-90deg); position: absolute; inset: 0; z-index: 10; width: 100%; height: 100%; }
    .ring-bg { fill: none; stroke: #e5e5ea; stroke-width: 8; }
    .ring-bar { fill: none; stroke: var(--blue); stroke-width: 8; stroke-linecap: round; stroke-dasharray: 283; stroke-dashoffset: 283; transition: stroke-dashoffset 0.8s linear; }
    
    .active .ring-bar { stroke: url(#rainbowGrad); }

    .coin {
      width: 140px; height: 140px; position: absolute; top: 20px; left: 20px;
      transform-style: preserve-3d; transition: transform 0.6s; z-index: 5;
    }
    .coin.spinning { animation: spin3d 4s infinite linear; }
    .face { 
        position: absolute; width: 100%; height: 100%; backface-visibility: hidden; 
        border-radius: 50%; background: #fff; overflow: hidden;
        box-shadow: inset 0 0 10px rgba(0,0,0,0.1);
        border: 2px solid #fff;
    }
    .face.back { transform: rotateY(180deg); }
    .face img { 
        width: 100%; height: 100%; 
        object-fit: cover; 
        display: block;
    }

    @keyframes spin3d { from { transform: rotateY(0deg); } to { transform: rotateY(360deg); } }

    .time-left { font-size: 50px; font-weight: 900; margin-top: 20px; letter-spacing: -2px; font-variant-numeric: tabular-nums; color: #d1d1d6; }
    .active .time-left { color: var(--text); }

    footer {
      background: #fff; border-top: 1px solid #e5e5e5; padding: 20px 40px; 
      display: flex; justify-content: space-between; align-items: center; z-index: 100;
      position: relative;
    }
    .btn-group { display: flex; gap: 10px; }
    .apple-btn {
      background: var(--text); color: #fff; border: none;
      padding: 12px 24px; border-radius: 12px; font-size: 14px; font-weight: 700;
      cursor: pointer; transition: 0.2s;
    }
    .apple-btn:hover { opacity: 0.8; transform: translateY(-2px); }
    .btn-gray { background: #e8e8ed; color: var(--text); }

    .mode-switch {
      position: absolute; top: -40px; right: 40px;
      background: var(--card-glass); backdrop-filter: blur(10px);
      padding: 5px; border-radius: 12px; border: 1px solid #e5e5e5;
      display: flex; gap: 5px;
    }
    .sw-btn {
      border: none; background: transparent; padding: 6px 12px; border-radius: 8px;
      font-size: 11px; font-weight: 800; cursor: pointer; color: var(--muted);
      text-transform: uppercase;
    }
    .sw-btn.active { background: var(--blue); color: #fff; }

    #animation-container { position: absolute; inset: 0; pointer-events: none; z-index: 0; }
    .firework { position: absolute; width: 6px; height: 6px; border-radius: 50%; animation: explode 1s ease-out forwards; z-index: 5; }
    @keyframes explode { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(40); opacity: 0; box-shadow: 0 0 30px 10px currentColor; } }

    @keyframes rainbowMove { 0% { background-position: 0% 50%; } 100% { background-position: 200% 50%; } }
    svg defs { height: 0; width: 0; }
    
    .speed-pill { background: #f2f2f7; padding: 4px; border-radius: 14px; display: flex; gap: 4px; }
    .speed-btn {
      border: none; background: transparent; padding: 8px 16px; border-radius: 10px;
      font-size: 12px; font-weight: 750; cursor: pointer; color: var(--muted);
    }
    .speed-btn.active { background: #fff; color: var(--text); box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
  </style>
</head>
<body id="body-main">

  <header>
    <div><span class="head-label">Date:</span><span class="head-val" id="dDisp">--.--.----</span></div>
    <h1>Mr. Oz Tech Zone Elite [FLASH]</h1>
    <div style="text-align: right;"><span class="head-label">Time:</span><span class="head-val" id="tDisp">00:00:00</span></div>
  </header>

  <div id="flight-deck">
    <div class="deck-lbl">Flash Simulation Active</div>
    <div id="slotTime" class="slot-timer">SPEED: <span id="speed-val">2</span>x</div>
  </div>

  <main id="main-stage">
    <div id="animation-container"></div>
    
    <div class="grid">
      <div class="card" id="card0">
        <div class="session-info">Session 1 â€” 3 Min</div>
        <div class="s-title">Login</div>
        <div class="circle-wrap">
          <svg class="ring-svg" viewBox="0 0 100 100">
            <defs>
              <linearGradient id="rainbowGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" stop-color="#ff3b30"/><stop offset="50%" stop-color="#007aff"/><stop offset="100%" stop-color="#ff3b30"/>
              </linearGradient>
            </defs>
            <circle class="ring-bg" cx="50" cy="50" r="45"/><circle class="ring-bar" id="ring0" cx="50" cy="50" r="45"/></svg>
          <div class="coin" id="coin0">
            <div class="face front"><img src="images/login.png"></div>
            <div class="face back"><img src="images/login.png"></div>
          </div>
        </div>
        <div class="time-left" id="tm0">03:00</div>
      </div>

      <div class="card" id="card1">
        <div class="session-info">Session 2 â€” 30 Min</div>
        <div class="s-title">Learning</div>
        <div class="circle-wrap">
          <svg class="ring-svg" viewBox="0 0 100 100"><circle class="ring-bg" cx="50" cy="50" r="45"/><circle class="ring-bar" id="ring1" cx="50" cy="50" r="45"/></svg>
          <div class="coin" id="coin1">
            <div class="face front"><img src="images/learning.png"></div>
            <div class="face back"><img src="images/learning.png"></div>
          </div>
        </div>
        <div class="time-left" id="tm1">30:00</div>
      </div>

      <div class="card" id="card2">
        <div class="session-info">Session 3 â€” 10 Min</div>
        <div class="s-title" id="phase3Title">Typing</div>
        <div class="circle-wrap">
          <svg class="ring-svg" viewBox="0 0 100 100"><circle class="ring-bg" cx="50" cy="50" r="45"/><circle class="ring-bar" id="ring2" cx="50" cy="50" r="45"/></svg>
          <div class="coin" id="coin2">
            <div class="face front"><img id="p3Front" src="images/typing.png"></div>
            <div class="face back"><img id="p3Back" src="images/nitrotype.jpg"></div>
          </div>
        </div>
        <div class="time-left" id="tm2">10:00</div>
      </div>

      <div class="card" id="card3">
        <div class="session-info">Session 4 â€” 2 Min</div>
        <div class="s-title">Logout</div>
        <div class="circle-wrap">
          <svg class="ring-svg" viewBox="0 0 100 100"><circle class="ring-bg" cx="50" cy="50" r="45"/><circle class="ring-bar" id="ring3" cx="50" cy="50" r="45"/></svg>
          <div class="coin" id="coin3">
            <div class="face front"><img src="images/logout4.png"></div>
            <div class="face back"><img src="images/logout4.png"></div>
          </div>
        </div>
        <div class="time-left" id="tm3">02:00</div>
      </div>
    </div>
  </main>

  <footer>
    <div class="mode-switch">
      <button class="sw-btn" onclick="location.href='index11.html'">Real</button>
      <button class="sw-btn" onclick="location.href='index12.html'">Sim</button>
      <button class="sw-btn active">Flash</button>
    </div>

    <div class="btn-group" id="footer-btns">
      <button class="apple-btn" onclick="startFlash()">START FLASH</button>
      <button onclick="playChime()" style="background:none; border:none; font-size:24px; cursor:pointer; margin-left:10px;">ðŸ””</button>
    </div>

    <div style="display: flex; gap: 20px;">
       <div class="speed-pill">
        <button class="speed-btn active" onclick="setSpeed(2)">2x</button>
        <button class="speed-btn" onclick="setSpeed(3)">3x</button>
        <button class="speed-btn" onclick="setSpeed(5)">5x</button>
        <button class="speed-btn" onclick="setSpeed(10)">10x</button>
      </div>
    </div>
  </footer>

  <script>
    const mins = [3, 30, 10, 2], names = ["Login", "Learning", "Typing", "Logout"];
    let anchor = null, activeIdx = -1, audioCtx = null, voices = [];
    let speed = 2;
    const animContainer = document.getElementById('animation-container');

    function loadVoices() { voices = window.speechSynthesis.getVoices(); }
    loadVoices();
    if (speechSynthesis.onvoiceschanged !== undefined) { speechSynthesis.onvoiceschanged = loadVoices; }

    function getBestVoice() {
      const preferred = ["Samantha", "Siri", "Google US English", "Microsoft Zira", "English (United States)"];
      for (let p of preferred) {
        let v = voices.find(v => v.name.includes(p) || v.voiceURI.includes(p));
        if (v) return v;
      }
      return voices.find(v => v.lang.includes("en")) || voices[0];
    }

    function createFirework() {
      const f = document.createElement('div'); f.className = 'firework';
      f.style.left = Math.random() * 80 + 10 + 'vw'; f.style.top = Math.random() * 60 + 20 + 'vh';
      f.style.color = `hsl(${Math.random()*360}, 100%, 50%)`;
      animContainer.appendChild(f); setTimeout(() => f.remove(), 1000);
    }

    function getAudio() {
      if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      if(audioCtx.state === 'suspended') audioCtx.resume();
      return audioCtx;
    }

    function playChime() {
      const ctx = getAudio(); const now = ctx.currentTime + 0.1; 
      [554, 440, 329, 277].forEach((f, i) => {
        const o = ctx.createOscillator(); const g = ctx.createGain();
        o.frequency.setValueAtTime(f, now + i * 0.45); g.gain.setValueAtTime(0, now + i * 0.45);
        g.gain.linearRampToValueAtTime(0.2, now + i * 0.45 + 0.05); g.gain.exponentialRampToValueAtTime(0.01, now + (i + 1.2) * 0.85);
        o.connect(g); g.connect(ctx.destination); o.start(now + i * 0.45); o.stop(now + (i + 1.2) * 0.85);
      });
    }

    async function announce(idx) {
      await new Promise(r => setTimeout(r, 100)); playChime(); createFirework();
      await new Promise(r => setTimeout(r, 2300));
      let msg = "";
      if (idx === 0) msg = "Please login to your accounts.";
      else if (idx === 1) msg = "Dear students you can start working on learning.com right now. this session is going to take 30 min. Please do not remove any equipment, mouse, keyboard, headphones, from the desktop computers. If you need anything please ask your teacher for assistance.";
      else if (idx === 2) msg = "Typing session started. you can start working on typing.com or nitrotype.com now.";
      else if (idx === 3) msg = "Dear Students. The class is over now, please log out from your accounts, close your chromebooks, organize your desk,.. Please Stand up Push your chairs And stand up right next to your chair. Please wait until your teacher dismiss you. Have a wonderful day";
      
      const utterance = new SpeechSynthesisUtterance(msg); utterance.voice = getBestVoice();
      utterance.rate = 1.2; // Speed up announcements too
      window.speechSynthesis.speak(utterance);
    }

    function startFlash() {
      const d = new Date(); d.setHours(8, 0, 0, 0); 
      anchor = { real: Date.now(), fake: d.getTime() };
      activeIdx = -1;
    }

    function setSpeed(val) {
      if (anchor) {
        // Recalculate anchor to prevent time jump
        const currentSimTime = anchor.fake + (Date.now() - anchor.real) * speed;
        anchor = { real: Date.now(), fake: currentSimTime };
      }
      speed = val;
      document.querySelectorAll('.speed-btn').forEach(b => {
        b.classList.toggle('active', parseInt(b.innerText) === val);
      });
      document.getElementById('speed-val').innerText = val;
    }

    function tick() {
      const realNow = new Date();
      document.getElementById('dDisp').textContent = `${String(realNow.getMonth()+1).padStart(2,'0')}.${String(realNow.getDate()).padStart(2,'0')}.${realNow.getFullYear()}`;
      
      if (!anchor) {
        document.getElementById('tDisp').textContent = realNow.toLocaleTimeString('tr-TR', {hour12:false});
        return;
      }

      const simNow = new Date(anchor.fake + (Date.now() - anchor.real) * speed);
      document.getElementById('tDisp').textContent = simNow.toLocaleTimeString('tr-TR', {hour12:false});

      const totalSecs = simNow.getHours() * 3600 + simNow.getMinutes() * 60 + simNow.getSeconds();
      const simStart = 8 * 3600;
      let acc = simStart;

      for (let i = 0; i < 4; i++) {
        const card = document.getElementById(`card${i}`), ring = document.getElementById(`ring${i}`), tm = document.getElementById(`tm${i}`), coin = document.getElementById(`coin${i}`);
        const dur = mins[i] * 60;
        if (totalSecs >= acc && totalSecs < acc + dur) {
          if (activeIdx !== i) { announce(i); activeIdx = i; }
          card.classList.add('active'); coin.classList.add('spinning');
          const rem = acc + dur - totalSecs;
          tm.textContent = new Date(rem * 1000).toISOString().substr(14, 5);
          ring.style.strokeDashoffset = 283 - ((totalSecs - acc) / dur * 283);
        } else {
          card.classList.remove('active'); coin.classList.remove('spinning');
          ring.style.strokeDashoffset = (totalSecs >= acc + dur) ? 0 : 283;
          tm.textContent = (totalSecs >= acc + dur) ? "DONE" : `${mins[i].toString().padStart(2, '0')}:00`;
        }
        acc += dur;
      }
    }
    setInterval(tick, 1000); tick();
  </script>
</body>
</html>
